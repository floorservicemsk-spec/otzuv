# üîÑ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ v2.0: –§–æ—Ä–º—ã –≤–º–µ—Å—Ç–æ –ø–æ–¥–¥–æ–º–µ–Ω–æ–≤

## ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ë–´–õ–û (v1.0):
- ‚ùå –ö–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–ª –ø–æ–¥–¥–æ–º–µ–Ω: `client.yourservice.com`
- ‚ùå –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã (–Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å)
- ‚ùå –î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö –ë–î

### –°–¢–ê–õ–û (v2.0):
- ‚úÖ –ö–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É: `yourservice.com/form/abc123xyz`
- ‚úÖ **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª–µ–π** - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π, —Ç–∏–ø–æ–≤, –ø–æ—Ä—è–¥–∫–∞
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ JSON (–≥–∏–±–∫–æ—Å—Ç—å)
- ‚úÖ Embed –∫–æ–¥ –∏ –≤–∏–¥–∂–µ—Ç —Å form_id

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (database_v2.sql)

**–¢–∞–±–ª–∏—Ü–∞ `users`:**
```sql
- subdomain varchar(100)  ‚ùå –£–î–ê–õ–ï–ù–û
+ form_id varchar(32)      ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û
```

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `form_fields`:**
```sql
CREATE TABLE `form_fields` (
  `id` int PRIMARY KEY,
  `user_id` int,
  `field_key` varchar(50),        -- phone, name, custom_address
  `field_label` varchar(255),      -- "–í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
  `field_type` enum(...),          -- text, email, tel, rating, etc
  `is_required` tinyint(1),
  `is_enabled` tinyint(1),
  `field_order` int,
  `placeholder` varchar(255)
)
```

**–¢–∞–±–ª–∏—Ü–∞ `form_submissions`:**
```sql
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ (phone, name, email, etc)  ‚ùå –£–î–ê–õ–ï–ù–û
+ form_data LONGTEXT (JSON)                     ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û
```

---

### 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (register.php)

**–ë–´–õ–û:**
```html
<input type="text" name="subdomain" placeholder="mycompany">
<span>.yourservice.com</span>
```

**–°–¢–ê–õ–û:**
```php
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è form_id
$form_id = bin2hex(random_bytes(7)); // "abc123xyz4567"
```

‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ: –ö–æ–º–ø–∞–Ω–∏—è + Email + –ü–∞—Ä–æ–ª—å

---

### 3. –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª–µ–π (dashboard/fields.php)

**–ù–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é:** üìã –ü–æ–ª—è —Ñ–æ—Ä–º—ã

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ
- ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ
- üîß –ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø (text/email/tel/number/textarea/rating/checkbox)
- ‚úÖ –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –ø–æ–ª–µ
- ‚ö° –°–¥–µ–ª–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º/–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º
- ‚¨ÜÔ∏è‚¨áÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ (drag & drop)
- üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–µ
- üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ä–º—ã

---

### 4. –§–æ—Ä–º–∞ (form.php)

**–ë–´–õ–û:**
```
URL: https://client.yourservice.com/form.php
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ: subdomain
```

**–°–¢–ê–õ–û:**
```
URL: https://yourservice.com/form.php?id=abc123xyz
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ: form_id –∏–∑ GET –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
```

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è:
```php
$stmt = $pdo->prepare("
    SELECT * FROM form_fields 
    WHERE user_id = ? AND is_enabled = 1 
    ORDER BY field_order
");

foreach ($form_fields as $field) {
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –Ω–∞ –æ—Å–Ω–æ–≤–µ field_type
}
```

---

### 5. API (api/submit_v2.php)

**–ë–´–õ–û:**
```php
POST /api/submit.php
Content-Type: application/x-www-form-urlencoded

phone=123&name=Ivan&email=test@test.com&sales_rating=5
```

**–°–¢–ê–õ–û:**
```php
POST /api/submit_v2.php
Content-Type: application/json

{
  "user_id": 1,
  "form_id": "abc123xyz",
  "fields": {
    "phone": "+7 (999) 123-45-67",
    "name": "–ò–≤–∞–Ω",
    "email": "test@test.com",
    "custom_address": "–ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞ 1"
  }
}
```

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î:
```php
INSERT INTO form_submissions (user_id, form_data) 
VALUES (?, '{"phone": "+7...", "name": "–ò–≤–∞–Ω", ...}')
```

---

### 6. –í–∏–¥–∂–µ—Ç (widget.js)

**–ë–´–õ–û:**
```html
<script src="https://client.yourservice.com/widget.js"></script>
```

**–°–¢–ê–õ–û:**
```html
<script src="https://yourservice.com/widget.js?form=abc123xyz"></script>
```

–ò–ª–∏ —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º:
```html
<script src="https://yourservice.com/widget.js" data-form-id="abc123xyz"></script>
```

---

### 7. Embed –∫–æ–¥

**–ü—Ä–æ—Å—Ç–æ–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ:**
```html
<iframe src="https://yourservice.com/form.php?id=abc123xyz" 
        width="100%" 
        height="600" 
        frameborder="0">
</iframe>
```

---

### 8. Dashboard (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)

**dashboard/index.php:**
```php
$form_url = PROTOCOL . MAIN_DOMAIN . '/form.php?id=' . $user['form_id'];
$widget_url = PROTOCOL . MAIN_DOMAIN . '/widget.js?form=' . $user['form_id'];
```

**dashboard/submissions.php:**
- –¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è
- –ö–∞—Ä—Ç–æ—á–Ω—ã–π –≤–∏–¥ –≤–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü—ã

---

## üìÅ –§–∞–π–ª—ã

### –ù–æ–≤—ã–µ:
- `database_v2.sql` - –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î
- `dashboard/fields.php` - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª–µ–π
- `api/submit_v2.php` - API –¥–ª—è JSON –¥–∞–Ω–Ω—ã—Ö

### –ò–∑–º–µ–Ω–µ–Ω—ã:
- `register.php` - –±–µ–∑ –ø–æ–¥–¥–æ–º–µ–Ω–∞
- `form.php` - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- `widget.js` - —Ä–∞–±–æ—Ç–∞ —Å form_id
- `dashboard/index.php` - –Ω–æ–≤—ã–µ URL
- `dashboard/submissions.php` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ JSON

### –°—Ç–∞—Ä—ã–µ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã):
- `register_old.php`
- `form_old.php`
- `widget_old.js`

---

## üöÄ –ú–∏–≥—Ä–∞—Ü–∏—è —Å v1.0 –Ω–∞ v2.0

### –®–∞–≥ 1: –ë—ç–∫–∞–ø
```bash
mysqldump -u warranty_user -p warranty_saas > backup_v1.sql
```

### –®–∞–≥ 2: –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î

**–î–æ–±–∞–≤–∏—Ç—å form_id –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:**
```sql
ALTER TABLE users ADD COLUMN form_id VARCHAR(32) AFTER subdomain;

UPDATE users 
SET form_id = MD5(CONCAT(subdomain, id)) 
WHERE form_id IS NULL OR form_id = '';

-- –°–¥–µ–ª–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
ALTER TABLE users ADD UNIQUE KEY (form_id);
```

**–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É form_fields:**
```sql
-- –ó–∞–ø—É—Å—Ç–∏—Ç–µ database_v2.sql –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
```

**–°–æ–∑–¥–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
```sql
INSERT INTO form_fields (user_id, field_key, field_label, field_type, field_order)
SELECT id, 'phone', '–í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞', 'tel', 1 FROM users WHERE role='client'
UNION ALL
SELECT id, 'name', '–í–∞—à–µ –∏–º—è', 'text', 2 FROM users WHERE role='client'
UNION ALL
SELECT id, 'email', '–í–∞—à–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞', 'email', 3 FROM users WHERE role='client';
```

### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã
```bash
git pull origin main
# –ò–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
```

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º—É
https://yourservice.com/form.php?id=abc123xyz

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–¥–∂–µ—Ç
curl https://yourservice.com/widget.js?form=abc123xyz
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ v2.0

### 1. –ì–∏–±–∫–æ—Å—Ç—å
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º —Ä–µ—à–∞–µ—Ç –∫–∞–∫–∏–µ –ø–æ–ª—è –Ω—É–∂–Ω—ã
- ‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–µ–π
- ‚úÖ –õ—é–±—ã–µ —Ç–∏–ø—ã: —Ç–µ–∫—Å—Ç, email, —Ç–µ–ª–µ—Ñ–æ–Ω, —Ä–µ–π—Ç–∏–Ω–≥–∏, —á–µ–∫–±–æ–∫—Å—ã

### 2. –ü—Ä–æ—Å—Ç–æ—Ç–∞
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å DNS –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ –ù–µ—Ç wildcard SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- ‚úÖ –ü—Ä–æ—â–µ –¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ shared —Ö–æ—Å—Ç–∏–Ω–≥–µ

### 3. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- ‚úÖ JSON —Ñ–æ—Ä–º–∞—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ ALTER TABLE –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–ª–µ–π
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –ø–æ–ª–µ–π

### 4. UX
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–π URL: `yourservice.com/form/abc123`
- ‚úÖ –õ–µ–≥–∫–æ —à–∞—Ä–∏—Ç—å (–±–µ–∑ *.subdomain.com)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ (–¥–∞–∂–µ –±–µ–∑ wildcard)

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ "–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏"

1. –ó–∞–π—Ç–∏ –≤ Dashboard ‚Üí –ü–æ–ª—è —Ñ–æ—Ä–º—ã
2. –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ"
3. –ù–∞–∑–≤–∞–Ω–∏–µ: "–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏"
4. –¢–∏–ø: "–î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç"
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

‚úÖ –ü–æ–ª–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Ñ–æ—Ä–º–µ!

### –ü—Ä–∏–º–µ—Ä 2: –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π

1. Dashboard ‚Üí –ü–æ–ª—è —Ñ–æ—Ä–º—ã
2. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å –ø–æ–ª—è (drag & drop)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

‚úÖ –ü–æ—Ä—è–¥–æ–∫ –∏–∑–º–µ–Ω–∏—Ç—Å—è –≤ —Ñ–æ—Ä–º–µ!

### –ü—Ä–∏–º–µ—Ä 3: –í—Å—Ç—Ä–æ–∏—Ç—å —Ñ–æ—Ä–º—É –Ω–∞ —Å–∞–π—Ç

**–í–∞—Ä–∏–∞–Ω—Ç 1: –í–∏–¥–∂–µ—Ç (–ø–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞)**
```html
<script src="https://yourservice.com/widget.js?form=abc123"></script>
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –í—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä—è–º–æ –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—É**
```html
<iframe src="https://yourservice.com/form.php?id=abc123" 
        width="100%" 
        height="800" 
        frameborder="0"
        style="border-radius: 16px;">
</iframe>
```

---

## üìû –í–æ–ø—Ä–æ—Å—ã?

- üìñ README.md - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- üöÄ QUICKSTART.md - —É—Å—Ç–∞–Ω–æ–≤–∫–∞
- üìã CREDENTIALS.md - —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞:** 31.10.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ
